Refactor the implementation for: $ARGUMENTS while maintaining test coverage

Steps:

1. Run full test suite to establish green baseline
2. Identify refactoring opportunities in the implementation:
   - Code duplication
   - Long methods/functions
   - Poor naming
   - Complex conditionals
   - Violation of SOLID principles
3. Make ONE refactoring change at a time
4. Run tests after EACH change
5. If tests fail, revert the change and try a different approach
6. Continue until code is clean and maintainable

Show me:

- What you're refactoring and why
- Test results after each change
- Final comparison of before/after code

Remember: If tests break during refactoring, the tests are right!
